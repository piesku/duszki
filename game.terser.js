(()=>{function t(t,i){let h=t.i.t();for(let e of i)e(t,h);return h}function i(t,i,h){let e=t.createShader(i);return t.shaderSource(e,h),t.compileShader(e),e}function h(t,i,h,e,n,o,s){return t[0]=i,t[1]=h,t[2]=e,t[3]=n,t[4]=o,t[5]=s,t}function e(t,i){let h=i[0],e=i[1],n=i[2],o=i[3],s=i[4],g=i[5],r=h*o-e*n;return r?(r=1/r,t[0]=o*r,t[1]=-e*r,t[2]=-n*r,t[3]=h*r,t[4]=(n*g-o*s)*r,t[5]=(e*s-h*g)*r,t):null}function n(t,i,h){let e=i[0],n=i[1],o=i[2],s=i[3],g=i[4],r=i[5],d=h[0],c=h[1],l=h[2],u=h[3],a=h[4],w=h[5];return t[0]=e*d+o*c,t[1]=n*d+s*c,t[2]=e*l+o*u,t[3]=n*l+s*u,t[4]=e*a+o*w+g,t[5]=n*a+s*w+r,t}function o(t,i,h,e){let n=Math.sin(h),o=Math.cos(h);return t[0]=o*e[0],t[1]=n*e[0],t[2]=-n*e[1],t[3]=o*e[1],t[4]=i[0],t[5]=i[1],t}function s(t,i){return t[0]=i[4],t[1]=i[5],t}function g(t,i,e){return h(t,i,0,0,e,0,0),t}function r(t,i){s(i.h,t),i.o[0]=i.h[0]-i.g[0]/2,i.o[1]=i.h[1]-i.g[1]/2,i.l[0]=i.h[0]+i.g[0]/2,i.l[1]=i.h[1]+i.g[1]/2}function d(t,i){let h=t.h[0]-i.h[0],e=t.g[0]/2+i.g[0]/2-Math.abs(h),n=t.h[1]-i.h[1],o=t.g[1]/2+i.g[1]/2-Math.abs(n);return e<o?[e*Math.sign(h),0]:[0,o*Math.sign(n)]}function c(t,i,h){for(let o=0;o<h;o++){let h=i[o],s=t.u&h.p,g=h.u&t.p;if((s||g)&&(e=t).o[0]<(n=h).l[0]&&e.l[0]>n.o[0]&&e.o[1]<n.l[1]&&e.l[1]>n.o[1]){let i=d(t,h);s&&t.v.push({m:h._,M:i}),g&&h.v.push({m:t._,M:[-i[0],-i[1]]})}}var e,n}function l(t,i){let h=t.i.T[i],e=t.i.k[i];h.S&&(e.S[0]=h.S[0],e.S[1]=h.S[1],t.i.F[i]|=64),h.$&&(e.$=h.$,t.i.F[i]|=64)}function u(t,i){let h=t.i.k[i],e=t.i.A[i];t.C.ArrowLeft&&(h.S[0]-=1,t.i.F[i]|=64),t.C.ArrowRight&&(h.S[0]+=1,t.i.F[i]|=64),t.C.ArrowUp&&e.P&&(e.R[1]=500)}function a(t,i){return t[0]=i[0],t[1]=i[1],t}function w(t,i,h){return t[0]=i[0]+h[0],t[1]=i[1]+h[1],t}function p(t,i,h){return t[0]=i[0]*h,t[1]=i[1]*h,t}function y(t,i){let h=i[0],e=i[1],n=h*h+e*e;return n>0&&(n=1/Math.sqrt(n)),t[0]=i[0]*n,t[1]=i[1]*n,t}function x(t,i,h){let e=i[0],n=i[1];return t[0]=h[0]*e+h[2]*n+h[4],t[1]=h[1]*e+h[3]*n+h[5],t}function f(t=[0,0],i=0,h=[1,1]){return(e,n)=>{e.i.F[n]|=576,e.i.X[n]={Y:t,$:i,D:h}}}function v(t){return(i,h)=>{a(i.i.X[h].Y,t)}}function m(t,i,h,e=[1,1]){return(n,o)=>{n.i.F[o]|=4,n.i.U[o]={_:o,V:!0,W:t,p:i,u:h,g:e,o:[0,0],l:[0,0],h:[0,0],v:[]}}}function _(t,i=[1,1,1,1]){return(h,e)=>{let n=e*Z;h.H[n+6]=0,h.H[n+7]=4096,h.H[n+8]=i[0],h.H[n+9]=i[1],h.H[n+10]=i[2],h.H[n+11]=i[3],h.H[n+12]=it[t].x,h.H[n+13]=it[t].y,h.H[n+14]=it[t].width,h.H[n+15]=it[t].height,h.i.F[e]|=4096,h.i.I[e]={j:h.H.subarray(n+6,n+8),L:h.H.subarray(n+8,n+12),O:h.H.subarray(n+12,n+16)}}}function M(t,i,h){let e=i*Z;t.H[e+12]=it[h].x,t.H[e+13]=it[h].y,t.H[e+14]=it[h].width,t.H[e+15]=it[h].height}function T(t,i=1,h=.001){return(e,n)=>{e.i.F[n]|=8192,e.i.A[n]={G:t,q:h,B:i,R:[0,0],K:[0,0],N:[0,0],J:0,P:!1}}}function b(t=!1){return(i,h)=>{i.i.F[h]|=32832,i.i.Z[h]={i:i.H.subarray(h*Z,h*Z+6),tt:[1,0,0,1,0,0],it:t}}}function k(t,i){if(32&t.F[i])for(let h of t.ht[i].ht)k(t,h);0===t.F[i]||t.et(i)}function z(t,i,h){let e=t.i.nt[i];e.ot-=h,e.ot<0&&k(t.i,i)}function S(t,i,h){let e=t.i.X[i],n=t.i.k[i];if(n.S[0]||n.S[1]){nt[0]=n.S[0],nt[1]=n.S[1];let s=Math.min(1,Math.hypot((o=nt)[0],o[1]));if(32768&t.i.F[i]){let h=t.i.Z[i];!function(t,i,h){let e=i[0],n=i[1];t[0]=h[0]*e+h[2]*n,t[1]=h[1]*e+h[3]*n}(nt,nt,void 0!==h.st?t.i.Z[h.st].tt:h.i)}else!function(t,i,h){let e=Math.cos(h),n=Math.sin(h);t[0]=e*i[0]-n*i[1],t[1]=n*i[0]+e*i[1]}(nt,nt,e.$);y(nt,nt),p(nt,nt,s*n.gt*h),w(e.Y,e.Y,nt),n.S[0]=0,n.S[1]=0}var o;n.$&&(e.$+=n.$*n.rt*h,n.$=0)}function F(t,i,h){let e=t.i.X[i],n=t.i.A[i];var o;1===n.G&&(n.K[1]+=-9.8*h,p(n.R,n.R,h),w(n.K,n.K,n.R),p(n.K,n.K,1-n.q),p(ot,n.K,h),w(e.Y,e.Y,ot),e.$+=n.J*h,t.i.F[i]|=64,(o=n.R)[0]=0,o[1]=0)}function $(t,i){let h=t.i.X[i],e=t.i.A[i],n=t.i.U[i];if(1===e.G){e.P=!1;let g=!1;for(let r=0;r<n.v.length;r++){let d=n.v[r];if(8192&t.i.F[d.m]){g=!0,w(h.Y,h.Y,d.M),t.i.F[i]|=64;let n=t.i.A[d.m];switch(n.G){case 0:y(gt,d.M),p(gt,gt,-2*((o=e.K)[0]*(s=gt)[0]+o[1]*s[1])),w(e.N,e.K,gt);break;case 1:a(e.N,n.K)}p(e.N,e.N,e.B),d.M[1]>0&&e.N[1]<1&&(e.N[1]=0,e.P=!0)}}g||a(e.N,e.K)}var o,s}function A(t,i){if(32&t.F[i]){let h=t.ht[i];for(let i of h.ht)if(131072&t.F[i])return!0}return!1}function C(t,i){let h=t.dt,e=t.ct;t.lt.useProgram(h.ut),t.lt.uniformMatrix3x2fv(h.yt.wt,!1,i.wt),t.lt.activeTexture(33984),t.lt.bindTexture(q,e.xt),t.lt.uniform1i(h.yt.ft,0),t.lt.uniform2f(h.yt.vt,e._t,e.Mt),t.lt.bindBuffer(G,t.Tt),t.lt.bufferData(G,t.H,35040),t.lt.drawArraysInstanced(h.bt,0,4,t.i.F.length)}function P(t,i,h){let e=t.i.kt[i];for(let h in e.zt)if(e.St<e.zt[h]){M(t,i,h);break}e.St+=h,e.St>=e.Ft&&(e.St-=e.Ft)}function R(t,i){let h=t.i.$t[i];h.At=t.At,h.Ct=t.Ct;let n=h.Pt,o=t.At/t.Ct;if(0===n.Rt[0]&&0===n.Rt[1]){let i=t.Ct/32/2;g(n.Xt,i*o,i)}else o<n.Rt[0]/n.Rt[1]?g(n.Xt,n.Rt[0],n.Rt[0]/o):g(n.Xt,n.Rt[1]*o,n.Rt[1]);e(n.Pt,n.Xt)}function X(t,i){let h=t.i.Yt[i],e=t.i.X[i];e.Y[0]=(Math.random()-.5)*h.Rt*2,e.Y[1]=(Math.random()-.5)*h.Rt*2,t.i.F[i]|=64}function Y(i,h,e){let n=i.i.Dt[h];n.Ut+=e,n.Ut>n.Vt&&(n.Ut=0,s(dt,i.i.Z[h].i),i.i.F.length-i.i.Wt.length<i.i.Ht&&t(i,[...n.It(i),v(dt)]))}function D(t,i,h){let e=t.i.jt[i];e.Ut+=h,e.Ut>e.Et&&(e.Ut=0,(t.i.F[i]&e.u)===e.u?t.i.F[i]&=~e.u:t.i.F[i]|=e.u)}function U(t,i){for(let i=0;i<t.i.F.length;i++)576==(576&t.i.F[i])&&(32768&t.i.F[i]?W(t,i):V(t,i))}function V(t,i){t.i.F[i]&=-65;let h=t.i.X[i],e=i*Z;t.H[e+0]=h.D[0],t.H[e+1]=h.D[1],t.H[e+2]=h.$*lt,t.H[e+4]=h.Y[0],t.H[e+5]=h.Y[1]}function W(t,i,h){t.i.F[i]&=-65;let g=t.i.X[i],r=t.i.Z[i];if(o(r.i,g.Y,g.$*lt,g.D),void 0!==h&&(r.st=h),void 0!==r.st&&(n(r.i,t.i.Z[r.st].i,r.i),r.it&&(s(ut,r.i),o(r.i,ut,g.$*lt,g.D))),e(r.tt,r.i),32&t.i.F[i]){let h=t.i.ht[i];for(let e=0;e<h.ht.length;e++){let n=h.ht[e];33280==(33280&t.i.F[n])&&W(t,n,i)}}}function H(t,i){let h=t.i.U[i];for(let t of h.v);}function I(t,...i){return t.reduce(((t,h)=>t+function(t){let i=t.shift();return"boolean"==typeof i||null==i?"":Array.isArray(i)?i.join(""):i}(i)+h))}function j(t,i){let h=I`
<div style="margin: 10px;">
<div>Click to spawn new duszki.</div>
<div>Use the arrow keys to move all duszki at once.</div>
<div>A duszek lives for ${10} seconds.</div>
</div>
`;h!==L&&(t.Lt.innerHTML=L=h)}function E(i,h){for(let e=0;e<h.data.length;e++){let n=h.data[e],o=268435455&n;if(0==o)continue;let s,g=e%h.width+.5,r=h.height-Math.floor(e/h.width)-.5;s=(n&xt)==xt?f([g,r],90):(n&ft)==ft?f([g,r],-90):(n&vt)==vt?f([g,r],180):n&pt?f([g,r],0,[-1,1]):n&yt?f([g,r],0,[1,-1]):f([g,r]),t(i,[s,_((o-1+".png").padStart(7,"0"))])}}var L,O,G=34962,q=3553,B=5126,K=document.getElementById("update"),N=document.getElementById("delta"),J=document.getElementById("fps"),Q=1/60,Z=16,tt=class extends class{constructor(t=1e4){this.F=[],this.Wt=[],this.Ht=t}t(){return this.Wt.length>0?this.Wt.pop():this.F.push(0)-1}et(t){this.F[t]=0,this.Wt.push(t)}}{constructor(){super(...arguments),this.kt=[],this.$t=[],this.U=[],this.T=[],this.Ot=[],this.ht=[],this.Gt=[],this.nt=[],this.X=[],this.k=[],this.qt=[],this.I=[],this.A=[],this.Yt=[],this.Z=[],this.Dt=[],this.Bt=[],this.jt=[],this.Kt=[]}},it={"000.png":{x:0,y:0,width:16,height:16},"001.png":{x:16,y:0,width:16,height:16},"002.png":{x:0,y:16,width:16,height:16},"003.png":{x:16,y:16,width:16,height:16},"004.png":{x:32,y:0,width:16,height:16},"005.png":{x:32,y:16,width:16,height:16},"006.png":{x:0,y:32,width:16,height:16},"007.png":{x:16,y:32,width:16,height:16},"008.png":{x:32,y:32,width:16,height:16},"009.png":{x:48,y:0,width:16,height:16},"010.png":{x:48,y:16,width:16,height:16},"011.png":{x:48,y:32,width:16,height:16},"012.png":{x:0,y:48,width:16,height:16},"013.png":{x:16,y:48,width:16,height:16},"014.png":{x:32,y:48,width:16,height:16},"015.png":{x:48,y:48,width:16,height:16},"016.png":{x:64,y:0,width:16,height:16},"017.png":{x:64,y:16,width:16,height:16},"018.png":{x:64,y:32,width:16,height:16},"019.png":{x:64,y:48,width:16,height:16},"020.png":{x:0,y:64,width:16,height:16},"021.png":{x:16,y:64,width:16,height:16},"022.png":{x:32,y:64,width:16,height:16},"023.png":{x:48,y:64,width:16,height:16},"024.png":{x:64,y:64,width:16,height:16},"025.png":{x:80,y:0,width:16,height:16},"026.png":{x:80,y:16,width:16,height:16},"027.png":{x:80,y:32,width:16,height:16},"028.png":{x:80,y:48,width:16,height:16},"029.png":{x:80,y:64,width:16,height:16},"030.png":{x:0,y:80,width:16,height:16},"031.png":{x:16,y:80,width:16,height:16},"032.png":{x:32,y:80,width:16,height:16},"033.png":{x:48,y:80,width:16,height:16},"034.png":{x:64,y:80,width:16,height:16},"035.png":{x:80,y:80,width:16,height:16},"036.png":{x:96,y:0,width:16,height:16},"037.png":{x:96,y:16,width:16,height:16},"038.png":{x:96,y:32,width:16,height:16},"039.png":{x:96,y:48,width:16,height:16},"040.png":{x:96,y:64,width:16,height:16},"041.png":{x:96,y:80,width:16,height:16},"042.png":{x:0,y:96,width:16,height:16},"043.png":{x:16,y:96,width:16,height:16},"044.png":{x:32,y:96,width:16,height:16},"045.png":{x:48,y:96,width:16,height:16},"046.png":{x:64,y:96,width:16,height:16},"047.png":{x:80,y:96,width:16,height:16},"048.png":{x:96,y:96,width:16,height:16},"049.png":{x:112,y:0,width:16,height:16},"050.png":{x:112,y:16,width:16,height:16},"051.png":{x:112,y:32,width:16,height:16},"052.png":{x:112,y:48,width:16,height:16},"053.png":{x:112,y:64,width:16,height:16},"054.png":{x:112,y:80,width:16,height:16},"055.png":{x:112,y:96,width:16,height:16},"056.png":{x:0,y:112,width:16,height:16},"057.png":{x:16,y:112,width:16,height:16},"058.png":{x:32,y:112,width:16,height:16},"059.png":{x:48,y:112,width:16,height:16},"060.png":{x:64,y:112,width:16,height:16},"061.png":{x:80,y:112,width:16,height:16},"062.png":{x:96,y:112,width:16,height:16},"063.png":{x:112,y:112,width:16,height:16},"064.png":{x:128,y:0,width:16,height:16},"065.png":{x:128,y:16,width:16,height:16},"066.png":{x:128,y:32,width:16,height:16},"067.png":{x:128,y:48,width:16,height:16},"068.png":{x:128,y:64,width:16,height:16},"069.png":{x:128,y:80,width:16,height:16},"070.png":{x:128,y:96,width:16,height:16},"071.png":{x:128,y:112,width:16,height:16},"072.png":{x:0,y:128,width:16,height:16},"073.png":{x:16,y:128,width:16,height:16},"074.png":{x:32,y:128,width:16,height:16},"075.png":{x:48,y:128,width:16,height:16},"076.png":{x:64,y:128,width:16,height:16},"077.png":{x:80,y:128,width:16,height:16},"078.png":{x:96,y:128,width:16,height:16},"079.png":{x:112,y:128,width:16,height:16},"080.png":{x:128,y:128,width:16,height:16},"081.png":{x:144,y:0,width:16,height:16},"082.png":{x:144,y:16,width:16,height:16},"083.png":{x:144,y:32,width:16,height:16},"084.png":{x:144,y:48,width:16,height:16},"085.png":{x:144,y:64,width:16,height:16},"086.png":{x:144,y:80,width:16,height:16},"087.png":{x:144,y:96,width:16,height:16},"088.png":{x:144,y:112,width:16,height:16},"089.png":{x:144,y:128,width:16,height:16},"090.png":{x:0,y:144,width:16,height:16},"091.png":{x:16,y:144,width:16,height:16},"092.png":{x:32,y:144,width:16,height:16},"093.png":{x:48,y:144,width:16,height:16},"094.png":{x:64,y:144,width:16,height:16},"095.png":{x:80,y:144,width:16,height:16},"096.png":{x:96,y:144,width:16,height:16},"097.png":{x:112,y:144,width:16,height:16},"098.png":{x:128,y:144,width:16,height:16},"099.png":{x:144,y:144,width:16,height:16},"100.png":{x:160,y:0,width:16,height:16},"101.png":{x:160,y:16,width:16,height:16},"102.png":{x:160,y:32,width:16,height:16},"103.png":{x:160,y:48,width:16,height:16},"104.png":{x:160,y:64,width:16,height:16},"105.png":{x:160,y:80,width:16,height:16},"106.png":{x:160,y:96,width:16,height:16},"107.png":{x:160,y:112,width:16,height:16},"108.png":{x:160,y:128,width:16,height:16},"109.png":{x:160,y:144,width:16,height:16},"110.png":{x:0,y:160,width:16,height:16},"111.png":{x:16,y:160,width:16,height:16},"112.png":{x:32,y:160,width:16,height:16},"113.png":{x:48,y:160,width:16,height:16},"114.png":{x:64,y:160,width:16,height:16},"115.png":{x:80,y:160,width:16,height:16},"116.png":{x:96,y:160,width:16,height:16},"117.png":{x:112,y:160,width:16,height:16},"118.png":{x:128,y:160,width:16,height:16},"119.png":{x:144,y:160,width:16,height:16},"120.png":{x:160,y:160,width:16,height:16},"121.png":{x:176,y:0,width:16,height:16},"122.png":{x:176,y:16,width:16,height:16},"123.png":{x:176,y:32,width:16,height:16},"124.png":{x:176,y:48,width:16,height:16},"125.png":{x:176,y:64,width:16,height:16},"126.png":{x:176,y:80,width:16,height:16},"127.png":{x:176,y:96,width:16,height:16},"128.png":{x:176,y:112,width:16,height:16},"129.png":{x:176,y:128,width:16,height:16},"130.png":{x:176,y:144,width:16,height:16},"131.png":{x:176,y:160,width:16,height:16}},ht=0,et=[0,0],nt=[0,0],ot=[0,0],st=8708,gt=[0,0],rt=131072,dt=[0,0],ct=262144,lt=Math.PI/180,ut=[0,0],at=524292,wt=[{data:[14,51,16,1,1,3221225485,1,1,1,2,3,3,3,3,3,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,14,1610612787,17,3,3,4,1,1,1,14,41,41,41,41,41,16,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1073741837,1,14,1610612787,58,41,41,16,25,1,1,14,1610612789,51,51,52,51,16,2,3,4,1,1,1,1,2,3,7,3,3,3,7,3,4,14,1610612787,51,52,51,16,1,1,1,14,1610612787,49,3221225522,49,49,16,14,41,16,1,1,536870925,1,14,41,19,41,30,41,19,41,16,14,1610612787,5,27,27,28,1,1073741837,1,14,1610612787,49,49,49,49,16,14,1610612789,16,1,1,1,1073741837,14,1610612789,31,51,51,52,31,51,16,14,1610612787,16,2,3,3,3,3,4,26,27,27,27,27,27,28,14,1610612787,17,7,3,3,4,14,1610612787,49,49,49,49,49,49,16,14,1610612787,16,14,41,41,41,41,17,3,3,3,3,4,1,1,14,1610612787,58,19,41,41,16,14,1610612787,49,49,49,49,49,49,16,18,1610612787,17,18,1610612789,51,52,51,58,41,41,22,41,16,2684354573,1,14,1610612787,51,31,51,51,16,14,1610612787,49,49,49,49,49,49,16,60,1610612787,58,60,1610612787,49,49,49,51,51,51,51,51,17,3,3,18,1610612787,49,43,49,3221225522,17,18,1610612787,49,49,49,49,49,2684354610,17,51,54,51,51,54,43,49,50,49,49,49,49,49,58,41,41,60,1610612787,49,49,43,49,58,60,37,38,38,38,38,38,39,58,49,43,49,49,49,49,49,49,49,49,49,49,49,51,52,51,51,54,49,49,49,49,51,52,54,49,49,49,49,49,49,51,49,49,49,5,27,6,1610612790,49,49,2147483698,49,49,49,49,49,49,49,49,49,49,49,49,49,5,27,27,27,27,27,27,27,27,49,49,49,16,1,14,1610612787,49,49,49,49,49,49,5,27,27,27,27,27,27,6,1610612790,49,16,1,1,1,1,1,1,1,1,27,27,27,28,3221225485,14,1610612787,49,49,5,27,27,27,28,2,3,3,3,3,3,18,1610612787,49,16,1,1,1,2,3,3,3,3,1,1,1,1,2,18,1610612787,49,49,17,3,4,1,1,14,41,20,41,41,21,60,1610612787,49,16,1,1,1073741837,14,41,11,12,41,1,2,3,3,18,60,1610612787,49,49,58,41,17,3,3,18,1610612789,32,51,51,33,51,54,2147483698,16,1,1,1,14,1610612789,51,51,51,1,14,41,41,60,1610612789,54,49,49,51,51,58,41,41,60,1610612787,49,43,49,49,49,49,49,17,3,3,3,18,1610612787,49,49,49,1,14,1610612789,52,51,54,49,49,2147483698,42,49,51,51,51,51,54,43,49,49,49,49,49,49,58,41,41,41,60,1610612787,49,49,49,1,14,1610612787,3758096434,49,49,49,49,49,3758096434,49,49,49,49,49,49,49,49,49,49,49,43,49,51,51,51,51,51,54,49,49,49,1,14,1610612787,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,3758096434,49],height:20,id:1,name:"Dungeon",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,87,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,0,65,0,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,67,0,67,0,67,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,121,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,62,0,0,0,0,0,0,0,0,74,0,73,0,0,0,0,0,121,0,0,0,0,0,0,0,65,0,0,0,0,0,62,88,62,0,0,0,0,0,0,0,0,0,0,74,0,0,0,0,0,0,0,0,0,0,0,0,67,0,0,0,0,0,98,62,0,0,0,0,0,85,0,0,0,2147483758,0,0,0,0,0,0,0,0,0,0,0,0,0,65,0,0,0,0,0,0,0,0,99,61,0,0,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,0,0,0,0,67,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,0,0,0,0,0,0,0,0,0,0,0,0,0,78,78,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,124,0,0,0,0,0,0,0,0,0,83,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,124,0,0,0,0,0,0,0,0,0,90,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,2147483773,0,0,0,0,0,0,0,0,2147483749,0,0,0,0,0,0,0,0,94,71,71,71,71,71,72,0,0,0,0,0,0,0,0,0,0,0,0,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:20,id:4,name:"Objects",opacity:1,type:"tilelayer",visible:!1,width:32,x:0,y:0},{data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:20,id:5,name:"Carts",opacity:1,type:"tilelayer",visible:!1,width:32,x:0,y:0}],pt=1<<31,yt=1<<30,xt=1610612736,ft=-1610612736,vt=-1073741824,mt=new class extends class extends class{constructor(){this.Nt=0,this.Jt=0,this.At=window.innerWidth,this.Ct=window.innerHeight,this.Qt=!0,this.C={MouseX:0,MouseY:0},this.Zt={MouseX:0,MouseY:0},this.ti={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.ii={},this.Lt=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.hi():this.ei())),this.Lt.addEventListener("contextmenu",(t=>t.preventDefault())),this.Lt.addEventListener("mousedown",(t=>{this.C["Mouse"+t.button]=1,this.Zt["Mouse"+t.button]=1})),this.Lt.addEventListener("mouseup",(t=>{this.C["Mouse"+t.button]=0,this.Zt["Mouse"+t.button]=-1})),this.Lt.addEventListener("mousemove",(t=>{this.C.MouseX=t.clientX,this.C.MouseY=t.clientY,this.Zt.MouseX=t.movementX,this.Zt.MouseY=t.movementY})),this.Lt.addEventListener("wheel",(t=>{t.preventDefault(),this.Zt.WheelY=t.deltaY})),this.Lt.addEventListener("touchstart",(t=>{t.target===this.Lt&&t.preventDefault(),1===t.touches.length&&(this.ii={});for(let i=0;i<t.touches.length;i++)this.ii[t.touches[i].identifier]=i;for(let i=0;i<t.changedTouches.length;i++){let h=t.changedTouches[i],e=this.ii[h.identifier];this.C["Touch"+e]=1,this.C[`Touch${e}X`]=h.clientX,this.C[`Touch${e}Y`]=h.clientY,this.Zt["Touch"+e]=1,this.Zt[`Touch${e}X`]=0,this.Zt[`Touch${e}Y`]=0}})),this.Lt.addEventListener("touchmove",(t=>{t.target===this.Lt&&t.preventDefault();for(let i=0;i<t.changedTouches.length;i++){let h=t.changedTouches[i],e=this.ii[h.identifier];this.Zt[`Touch${e}X`]=h.clientX-this.C[`Touch${e}X`],this.Zt[`Touch${e}Y`]=h.clientY-this.C[`Touch${e}Y`],this.C[`Touch${e}X`]=h.clientX,this.C[`Touch${e}Y`]=h.clientY}})),this.Lt.addEventListener("touchend",(t=>{t.target===this.Lt&&t.preventDefault();for(let i=0;i<t.changedTouches.length;i++){let h=this.ii[t.changedTouches[i].identifier];this.C["Touch"+h]=0,this.Zt["Touch"+h]=-1}})),this.Lt.addEventListener("touchcancel",(t=>{for(let i=0;i<t.changedTouches.length;i++){let h=this.ii[t.changedTouches[i].identifier];this.C["Touch"+h]=0,this.Zt["Touch"+h]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.C[t.code]=1,this.Zt[t.code]=1)})),window.addEventListener("keyup",(t=>{this.C[t.code]=0,this.Zt[t.code]=-1}))}ei(){let t=0,i=performance.now(),h=e=>{let n=(e-i)/1e3;for(i=e,this.Nt=requestAnimationFrame(h),this.ni(n),t+=n;t>=Q;)t-=Q,this.oi(Q);this.si(n),this.gi(n)};this.hi(),h(i)}hi(){cancelAnimationFrame(this.Nt),this.Nt=0}ni(t){this.Jt=performance.now();let i=Math.abs(this.Zt.MouseX)+Math.abs(this.Zt.MouseY);this.ti.Mouse+=i,1===this.C.Mouse0&&(this.ti.Mouse0+=i),1===this.C.Mouse1&&(this.ti.Mouse1+=i),1===this.C.Mouse2&&(this.ti.Mouse2+=i),1===this.C.Touch0&&(this.ti.Touch0+=Math.abs(this.Zt.Touch0X)+Math.abs(this.Zt.Touch0Y)),1===this.C.Touch1&&(this.ti.Touch1+=Math.abs(this.Zt.Touch1X)+Math.abs(this.Zt.Touch1Y))}oi(t){}si(t){}gi(t){this.Qt=!1,-1===this.Zt.Mouse0&&(this.ti.Mouse0=0),-1===this.Zt.Mouse1&&(this.ti.Mouse1=0),-1===this.Zt.Mouse2&&(this.ti.Mouse2=0),-1===this.Zt.Touch0&&(this.ti.Touch0=0),-1===this.Zt.Touch1&&(this.ti.Touch1=0);for(let t in this.Zt)this.Zt[t]=0;let i=performance.now()-this.Jt;K&&(K.textContent=i.toFixed(1)),N&&(N.textContent=(1e3*t).toFixed(1)),J&&(J.textContent=(1/t).toFixed())}}{constructor(){super(...arguments),this.ri=document.querySelector("#background"),this.di=this.ri.getContext("2d"),this.ci=document.querySelector("#foreground"),this.li=this.ci.getContext("2d"),this.ui=document.querySelector("#scene"),this.lt=this.ui.getContext("webgl2"),this.Audio=new AudioContext,this.ai=[],this.wi={}}}{constructor(){super(),this.i=new tt(65536),this.dt=function(t,h,e){let n=function(t,h,e){let n=t.createProgram();return t.attachShader(n,i(t,35633,h)),t.attachShader(n,i(t,35632,"#version 300 es\n\nprecision mediump float;\n\nuniform sampler2D sheet_texture;\n\nin vec2 vert_texcoord;\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color * texture(sheet_texture, vert_texcoord);\nif (frag_color.a == 0.0) {\ndiscard;\n}\n}\n")),t.linkProgram(n),n}(t,"#version 300 es\n\nuniform mat3x2 pv;\nuniform vec2 sheet_size;\n\n\nlayout(location=0) in vec2 attr_position;\nlayout(location=1) in vec2 attr_texcoord;\n\n\nlayout(location=2) in vec4 attr_rotation; \nlayout(location=3) in vec4 attr_translation; \nlayout(location=4) in vec4 attr_color;\nlayout(location=5) in vec4 attr_sprite;\n\nout vec2 vert_texcoord;\nout vec4 vert_color;\nout vec4 vert_sprite;\n\nvoid main() {\nint signature = int(attr_translation.w);\nif ((signature & 4096) == 4096) {\nmat3x2 world;\nif ((signature & 32768) == 32768) {\nworld = mat3x2(\nattr_rotation.xy,\nattr_rotation.zw,\nattr_translation.xy\n);\n} else {\nvec2 scale = attr_rotation.xy;\nfloat rotation = attr_rotation.z;\nworld = mat3x2(\ncos(rotation) * scale.x, sin(rotation) * scale.x,\n-sin(rotation) * scale.y, cos(rotation) * scale.y,\nattr_translation.xy\n);\n}\n\nvec3 world_position = mat3(world) * vec3(attr_position, 1);\nvec3 clip_position = mat3(pv) * world_position;\ngl_Position = vec4(clip_position.xy, -attr_translation.z, 1);\n\n\nvert_texcoord = (attr_sprite.xy + attr_sprite.zw * attr_texcoord) / sheet_size;\nvert_color = attr_color;\n} else {\n\ngl_Position.z = 2.0;\n}\n}");return{bt:5,ut:n,yt:{wt:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),ft:t.getUniformLocation(n,"sheet_texture"),vt:t.getUniformLocation(n,"sheet_size")}}}(this.lt),this.ct=function(t,i){let h=t.createTexture();return t.bindTexture(q,h),t.texImage2D(q,0,6408,6408,5121,i),t.texParameteri(q,10241,9728),t.texParameteri(q,10240,9728),t.texParameteri(q,10242,10497),t.texParameteri(q,10243,10497),{xt:h,_t:i.width,Mt:i.height}}(this.lt,document.querySelector("img")),this.H=new Float32Array(this.i.Ht*Z),this.Tt=this.lt.createBuffer(),this.pi="#763b36",this.yi=32,this.xi=20,this.lt.clearColor(0,0,0,0),this.lt.enable(3042),this.lt.blendFunc(770,771),function(t,i){let h=Float32Array.from([-.5,-.5,0,1,.5,-.5,1,1,-.5,.5,0,0,.5,.5,1,0]);t.bindBuffer(G,t.createBuffer()),t.bufferData(G,h,35044),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,B,!1,16,0),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,2,B,!1,16,8),t.bindBuffer(G,i),t.enableVertexAttribArray(2),t.vertexAttribDivisor(2,1),t.vertexAttribPointer(2,4,B,!1,64,0),t.enableVertexAttribArray(3),t.vertexAttribDivisor(3,1),t.vertexAttribPointer(3,4,B,!1,64,16),t.enableVertexAttribArray(4),t.vertexAttribDivisor(4,1),t.vertexAttribPointer(4,4,B,!1,64,32),t.enableVertexAttribArray(5),t.vertexAttribDivisor(5,1),t.vertexAttribPointer(5,4,B,!1,64,48)}(this.lt,this.Tt)}oi(t){!function(t,i){for(let h=0;h<t.i.F.length;h++)8704==(8704&t.i.F[h])&&F(t,h,i)}(this,t),U(this),function(t,i){let h=[],e=[];for(let i=0;i<t.i.F.length;i++)if(32772==(32772&t.i.F[i])){let n=t.i.Z[i],o=t.i.U[i];o.v=[],o.V?(o.V=!1,r(n.i,o)):o.W?(r(n.i,o),e.push(o)):h.push(o)}for(let t=0;t<e.length;t++)c(e[t],h,h.length),c(e[t],e,t)}(this),function(t,i){for(let i=0;i<t.i.F.length;i++)(t.i.F[i]&st)===st&&$(t,i);for(let i=0;i<t.i.F.length;i++)if((t.i.F[i]&st)===st){let h=t.i.A[i];1===h.G&&a(h.K,h.N)}}(this),function(t,i){for(let i=0;i<t.i.F.length;i++)(t.i.F[i]&at)===at&&H(t,i)}(this)}si(i){!function(t,i){let h=[];for(let e=0;e<t.i.F.length;e++)if((t.i.F[e]&rt)===rt){if(A(t.i,e))continue;let n=t.i.Bt[e];switch(n.G){case 0:n.fi(e)&&h.push(e);break;case 1:n.ot-=i,n.ot<0&&h.push(e);break;case 2:h.push(e)}}for(let i of h){let h=t.i.Bt[i];switch(h.G){case 2:h.vi(i);case 0:case 1:t.i.et(i)}delete t.i.Bt[i]}}(this,i),function(t,i){if(t.At==window.innerWidth&&t.Ct==window.innerHeight||(t.Qt=!0),t.Qt){t.At=t.ri.width=t.ui.width=t.ci.width=window.innerWidth,t.Ct=t.ri.height=t.ui.height=t.ci.height=window.innerHeight;for(let i=0;i<t.i.F.length;i++)2==(2&t.i.F[i])&&R(t,i)}}(this),function(t,i){t.ai=[];for(let i=0;i<t.i.F.length;i++)if(32770==(32770&t.i.F[i])){let o=t.i.$t[i],s=t.i.Z[i];n(o.wt,o.Pt.Pt,s.tt),h(o.i,(e=s.i)[0],e[1],e[2],e[3],e[4],e[5]),t.ai.push(i)}var e}(this),function(t,i){for(let i=0;i<t.i.F.length;i++)9232==(9232&t.i.F[i])&&u(t,i)}(this),function(i,h){let e=i.ai[0];var n,o,s;void 0!==e&&(ht+=h)>.1&&function(t,i){return 1===t.C.Touch0||-1===t.Zt.Touch0?(i[0]=t.C.Touch0X,i[1]=t.C.Touch0Y,!0):t.ti.Mouse>0&&(i[0]=t.C.MouseX,i[1]=t.C.MouseY,!0)}(i,et)&&function(t,i,h=i){return t.C["Mouse"+i]>0||t.C["Touch"+h]>0}(i,0)&&((n=et)[0]=(s=et)[0]/(o=i.i.$t[e]).At*2-1,n[1]=-s[1]/o.Ct*2+1,x(n,n,o.Pt.Xt),x(n,n,o.i),t(i,[b(),f(),m(!0,2,3),T(1,.3),(t,i)=>{t.i.F[i]|=16,t.i.Ot[i]={}},(t,i)=>{t.i.F[i]|=1024,t.i.k[i]={gt:7,rt:0,S:[0,0],$:0}},_("121.png"),(t,i)=>{t.i.F[i]|=256,t.i.nt[i]={ot:10,mi:void 0}},v(et)]),ht=0)}(this,i),function(t,i){for(let i=0;i<t.i.F.length;i++)1032==(1032&t.i.F[i])&&l(t,i)}(this),function(t,i){for(let h=0;h<t.i.F.length;h++)1600==(1600&t.i.F[h])&&S(t,h,i)}(this,i),function(t,i){for(let h=0;h<t.i.F.length;h++)256==(256&t.i.F[h])&&z(t,h,i)}(this,i),function(t,i){for(let i=0;i<t.i.F.length;i++)16896==(16896&t.i.F[i])&&X(t,i)}(this),function(t,i){for(let h=0;h<t.i.F.length;h++)(t.i.F[h]&ct)==ct&&D(t,h,i)}(this,i),function(t,i){for(let h=0;h<t.i.F.length;h++)98304==(98304&t.i.F[h])&&Y(t,h,i)}(this,i),U(this),function(t,i){let h=t.ai[0];if(void 0===h)return;let e=t.i.$t[h],n=t.di;n.resetTransform(),n.fillStyle=t.pi,n.fillRect(0,0,t.At,t.Ct),n.transform(e.wt[0]/2*t.At,-e.wt[1]/2*t.At,-e.wt[2]/2*t.Ct,e.wt[3]/2*t.Ct,(e.wt[4]+1)/2*t.At,(e.wt[5]+1)/2*t.Ct);for(let i=0;i<t.i.F.length;i++)if(32896==(32896&t.i.F[i])){let h=t.i.Z[i];n.save(),n.transform(h.i[0],-h.i[1],-h.i[2],h.i[3],h.i[4],-h.i[5]);let e=t.i.Gt[i];switch(e.G){case 1:n.fillStyle=e.L,n.fillRect(-e._t/2,-e.Mt/2,e._t,e.Mt);break;case 2:n.fillStyle=e.L,n.beginPath(),n.arc(0,0,e.Rt,e._i,e.Mi),n.fill()}n.restore()}}(this),function(t,i){for(let h=0;h<t.i.F.length;h++)4097==(4097&t.i.F[h])&&P(t,h,i)}(this,i),function(t,i){for(let i=0;i<t.i.F.length;i++){let h=36864&t.i.F[i],e=i*Z+7;t.H[e]!==h&&(t.H[e]=h)}for(let i of t.ai){let h=t.i.$t[i];t.lt.bindFramebuffer(36160,null),t.lt.viewport(0,0,t.At,t.Ct),t.lt.clear(16640),C(t,h);break}}(this),j(this)}};(O=mt).i=new tt(65536),O.Qt=!0,t(O,[...function(t){return[b(),f(),(i=[t.yi/2+1,t.xi/2+1],(t,h)=>{t.i.F[h]|=2,t.i.$t[h]={Pt:{Rt:i,Pt:[1/i[0],0,0,1/i[1],0,0],Xt:[i[0],0,0,i[1],0,0]},wt:[1,0,0,1,0,0],i:[1,0,0,1,0,0],At:0,Ct:0}})];var i}(O),(t,i)=>{let h=t.i.X[i];h.Y[0]=16,h.Y[1]=10}]),E(O,wt[0]),E(O,wt[1]),E(O,wt[2]),mt.ei(),window.$=function(t,i,h){}.bind(null,mt),window.game=mt})();
