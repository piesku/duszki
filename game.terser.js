(()=>{function t(t,i){let h=t.i.t();for(let n of i)n(t,h);return h}function i(t,i,h){let n=t.createShader(i);return t.shaderSource(n,h),t.compileShader(n),n}function h(t,i,h,n,e,o,s){return t[0]=i,t[1]=h,t[2]=n,t[3]=e,t[4]=o,t[5]=s,t}function n(t,i){let h=i[0],n=i[1],e=i[2],o=i[3],s=i[4],g=i[5],r=h*o-n*e;return r?(r=1/r,t[0]=o*r,t[1]=-n*r,t[2]=-e*r,t[3]=h*r,t[4]=(e*g-o*s)*r,t[5]=(n*s-h*g)*r,t):null}function e(t,i,h){let n=i[0],e=i[1],o=i[2],s=i[3],g=i[4],r=i[5],d=h[0],c=h[1],u=h[2],l=h[3],a=h[4],w=h[5];return t[0]=n*d+o*c,t[1]=e*d+s*c,t[2]=n*u+o*l,t[3]=e*u+s*l,t[4]=n*a+o*w+g,t[5]=e*a+s*w+r,t}function o(t,i,h,n){let e=Math.sin(h),o=Math.cos(h);return t[0]=o*n[0],t[1]=e*n[0],t[2]=-e*n[1],t[3]=o*n[1],t[4]=i[0],t[5]=i[1],t}function s(t,i){return t[0]=i[4],t[1]=i[5],t}function g(t,i,n){return h(t,i,0,0,n,0,0),t}function r(t,i){s(i.h,t),i.o[0]=i.h[0]-i.g[0]/2,i.o[1]=i.h[1]-i.g[1]/2,i.u[0]=i.h[0]+i.g[0]/2,i.u[1]=i.h[1]+i.g[1]/2}function d(t,i){let h=t.h[0]-i.h[0],n=t.g[0]/2+i.g[0]/2-Math.abs(h),e=t.h[1]-i.h[1],o=t.g[1]/2+i.g[1]/2-Math.abs(e);return n<o?[n*Math.sign(h),0]:[0,o*Math.sign(e)]}function c(t,i,h){for(let o=0;o<h;o++){let h=i[o],s=t.l&h.p,g=h.l&t.p;if((s||g)&&(n=t).o[0]<(e=h).u[0]&&n.u[0]>e.o[0]&&n.o[1]<e.u[1]&&n.u[1]>e.o[1]){let i=d(t,h);s&&t.v.push({m:h._,M:i}),g&&h.v.push({m:t._,M:[-i[0],-i[1]]})}}var n,e}function u(t,i){let h=t.i.T[i],n=t.i.k[i];h.F&&(n.F[0]=h.F[0],n.F[1]=h.F[1],t.i.$[i]|=64),h.A&&(n.A=h.A,t.i.$[i]|=64)}function l(t,i){let h=t.i.k[i],n=t.i.S[i];t.C.ArrowLeft&&(h.F[0]-=1,t.i.$[i]|=64),t.C.ArrowRight&&(h.F[0]+=1,t.i.$[i]|=64),t.C.ArrowUp&&n.P&&(n.X[1]=500)}function a(t,i){return t[0]=i[0],t[1]=i[1],t}function w(t,i,h){return t[0]=i[0]+h[0],t[1]=i[1]+h[1],t}function p(t,i,h){return t[0]=i[0]*h,t[1]=i[1]*h,t}function y(t,i){let h=i[0],n=i[1],e=h*h+n*n;return e>0&&(e=1/Math.sqrt(e)),t[0]=i[0]*e,t[1]=i[1]*e,t}function x(t,i,h){let n=i[0],e=i[1];return t[0]=h[0]*n+h[2]*e+h[4],t[1]=h[1]*n+h[3]*e+h[5],t}function f(t=[0,0],i=0,h=[1,1]){return(n,e)=>{n.i.$[e]|=576,n.i.Y[e]={D:t,A:i,R:h}}}function v(t,i){return(h,n)=>{let e=h.i.Y[n];e.D[0]=t,e.D[1]=i}}function m(t){return(i,h)=>{a(i.i.Y[h].D,t)}}function _(t,i,h,n=[1,1]){return(e,o)=>{e.i.$[o]|=4,e.i.U[o]={_:o,V:!0,W:t,p:i,l:h,g:n,o:[0,0],u:[0,0],h:[0,0],v:[]}}}function M(t,i=[1,1,1,1]){return(h,n)=>{let e=n*it;h.H[e+6]=0,h.H[e+7]=4096,h.H[e+8]=i[0],h.H[e+9]=i[1],h.H[e+10]=i[2],h.H[e+11]=i[3],h.H[e+12]=nt[t].x,h.H[e+13]=nt[t].y,h.H[e+14]=nt[t].width,h.H[e+15]=nt[t].height,h.i.$[n]|=4096,h.i.I[n]={j:h.H.subarray(e+6,e+8),L:h.H.subarray(e+8,e+12),O:h.H.subarray(e+12,e+16)}}}function T(t){return(i,h)=>{i.H[h*it+6]=Math.max(-1,Math.min(1,t))}}function b(t,i,h){let n=i*it;t.H[n+12]=nt[h].x,t.H[n+13]=nt[h].y,t.H[n+14]=nt[h].width,t.H[n+15]=nt[h].height}function k(t,i=1,h=.001){return(n,e)=>{n.i.$[e]|=8192,n.i.S[e]={G:t,q:h,B:i,X:[0,0],K:[0,0],N:[0,0],J:0,P:!1}}}function z(t,i){if(32&t.$[i])for(let h of t.Z[i].Z)z(t,h);0===t.$[i]||t.tt(i)}function F(t,i,h){let n=t.i.it[i];n.ht-=h,n.ht<0&&z(t.i,i)}function $(t,i,h){let n=t.i.Y[i],e=t.i.k[i];if(e.F[0]||e.F[1]){st[0]=e.F[0],st[1]=e.F[1];let s=Math.min(1,Math.hypot((o=st)[0],o[1]));if(32768&t.i.$[i]){let h=t.i.nt[i];!function(t,i,h){let n=i[0],e=i[1];t[0]=h[0]*n+h[2]*e,t[1]=h[1]*n+h[3]*e}(st,st,void 0!==h.et?t.i.nt[h.et].ot:h.i)}else!function(t,i,h){let n=Math.cos(h),e=Math.sin(h);t[0]=n*i[0]-e*i[1],t[1]=e*i[0]+n*i[1]}(st,st,n.A);y(st,st),p(st,st,s*e.st*h),w(n.D,n.D,st),e.F[0]=0,e.F[1]=0}var o;e.A&&(n.A+=e.A*e.gt*h,e.A=0)}function A(t,i,h){let n=t.i.Y[i],e=t.i.S[i];var o;1===e.G&&(e.K[1]+=-9.8*h,p(e.X,e.X,h),w(e.K,e.K,e.X),p(e.K,e.K,1-e.q),p(gt,e.K,h),w(n.D,n.D,gt),n.A+=e.J*h,t.i.$[i]|=64,(o=e.X)[0]=0,o[1]=0)}function S(t,i){let h=t.i.Y[i],n=t.i.S[i],e=t.i.U[i];if(1===n.G){n.P=!1;let g=!1;for(let r=0;r<e.v.length;r++){let d=e.v[r];if(8192&t.i.$[d.m]){g=!0,w(h.D,h.D,d.M),t.i.$[i]|=64;let e=t.i.S[d.m];switch(e.G){case 0:y(dt,d.M),p(dt,dt,-2*((o=n.K)[0]*(s=dt)[0]+o[1]*s[1])),w(n.N,n.K,dt);break;case 1:a(n.N,e.K)}p(n.N,n.N,n.B),d.M[1]>0&&n.N[1]<1&&(n.N[1]=0,n.P=!0)}}g||a(n.N,n.K)}var o,s}function C(t,i){if(32&t.$[i]){let h=t.Z[i];for(let i of h.Z)if(131072&t.$[i])return!0}return!1}function P(t,i){let h=t.rt,n=t.dt;t.ct.useProgram(h.ut),t.ct.uniformMatrix3x2fv(h.wt.lt,!1,i.lt),t.ct.activeTexture(33984),t.ct.bindTexture(K,n.yt),t.ct.uniform1i(h.wt.xt,0),t.ct.uniform2f(h.wt.ft,n.vt,n._t),t.ct.bindBuffer(B,t.Mt),t.ct.bufferData(B,t.H,35040),t.ct.drawArraysInstanced(h.Tt,0,4,t.i.$.length)}function X(t,i,h){let n=t.i.bt[i];for(let h in n.kt)if(n.zt<n.kt[h]){b(t,i,h);break}n.zt+=h,n.zt>=n.Ft&&(n.zt-=n.Ft)}function Y(t,i){let h=t.i.$t[i];h.At=t.At,h.St=t.St;let e=h.Ct,o=t.At/t.St;if(0===e.Pt[0]&&0===e.Pt[1]){let i=t.St/32/2;g(e.Xt,i*o,i)}else o<e.Pt[0]/e.Pt[1]?g(e.Xt,e.Pt[0],e.Pt[0]/o):g(e.Xt,e.Pt[1]*o,e.Pt[1]);n(e.Ct,e.Xt)}function D(t,i){let h=t.i.Yt[i],n=t.i.Y[i];n.D[0]=(Math.random()-.5)*h.Pt*2,n.D[1]=(Math.random()-.5)*h.Pt*2,t.i.$[i]|=64}function R(i,h,n){let e=i.i.Dt[h];e.Rt+=n,e.Rt>e.Ut&&(e.Rt=0,s(ut,i.i.nt[h].i),i.i.$.length-i.i.Vt.length<i.i.Wt&&t(i,[...e.Ht(i),m(ut)]))}function U(t,i,h){let n=t.i.It[i];n.Rt+=h,n.Rt>n.jt&&(n.Rt=0,(t.i.$[i]&n.l)===n.l?t.i.$[i]&=~n.l:t.i.$[i]|=n.l)}function V(t,i){for(let i=0;i<t.i.$.length;i++)576==(576&t.i.$[i])&&(32768&t.i.$[i]?H(t,i):W(t,i))}function W(t,i){t.i.$[i]&=-65;let h=t.i.Y[i],n=i*it;t.H[n+0]=h.R[0],t.H[n+1]=h.R[1],t.H[n+2]=h.A*at,t.H[n+4]=h.D[0],t.H[n+5]=h.D[1]}function H(t,i,h){t.i.$[i]&=-65;let g=t.i.Y[i],r=t.i.nt[i];if(o(r.i,g.D,g.A*at,g.R),void 0!==h&&(r.et=h),void 0!==r.et&&(e(r.i,t.i.nt[r.et].i,r.i),r.Et&&(s(wt,r.i),o(r.i,wt,g.A*at,g.R))),n(r.ot,r.i),32&t.i.$[i]){let h=t.i.Z[i];for(let n=0;n<h.Z.length;n++){let e=h.Z[n];33280==(33280&t.i.$[e])&&H(t,e,i)}}}function I(t,i){let h=t.i.U[i];for(let t of h.v);}function j(t,...i){return t.reduce(((t,h)=>t+function(t){let i=t.shift();return"boolean"==typeof i||null==i?"":Array.isArray(i)?i.join(""):i}(i)+h))}function E(t,i){let h=j`
<div style="margin: 10px;">
<div>Click to spawn new duszki.</div>
<div>Use the arrow keys to move all duszki at once.</div>
<div>A duszek lives for ${10} seconds.</div>
</div>
`;h!==G&&(t.Lt.innerHTML=G=h)}function L(i,h,n){for(let e=0;e<h.data.length;e++){let o=h.data[e],s=268435455&o;if(0==s)continue;let g,r=e%h.width+.5,d=h.height-Math.floor(e/h.width)-.5;g=1610612736==(1610612736&o)?f([r,d],90):-1610612736==(-1610612736&o)?f([r,d],-90):-1073741824==(-1073741824&o)?f([r,d],180):-2147483648&o?f([r,d],0,[-1,1]):1073741824&o?f([r,d],0,[1,-1]):f([r,d]),t(i,[g,M((s-1+".png").padStart(7,"0")),T(n)])}}function O(t=!1){return(i,h)=>{i.i.$[h]|=32832,i.i.nt[h]={i:i.H.subarray(h*it,h*it+6),ot:[1,0,0,1,0,0],Et:t}}}var G,q,B=34962,K=3553,N=5126,J=document.getElementById("update"),Q=document.getElementById("delta"),Z=document.getElementById("fps"),tt=1/60,it=16,ht=class extends class{constructor(t=1e4){this.$=[],this.Vt=[],this.Wt=t}t(){return this.Vt.length>0?this.Vt.pop():this.$.push(0)-1}tt(t){this.$[t]=0,this.Vt.push(t)}}{constructor(){super(...arguments),this.bt=[],this.$t=[],this.U=[],this.T=[],this.Ot=[],this.Z=[],this.Gt=[],this.it=[],this.Y=[],this.k=[],this.qt=[],this.I=[],this.S=[],this.Yt=[],this.nt=[],this.Dt=[],this.Bt=[],this.It=[],this.Kt=[]}},nt={"000.png":{x:0,y:0,width:16,height:16},"001.png":{x:16,y:0,width:16,height:16},"002.png":{x:0,y:16,width:16,height:16},"003.png":{x:16,y:16,width:16,height:16},"004.png":{x:32,y:0,width:16,height:16},"005.png":{x:32,y:16,width:16,height:16},"006.png":{x:0,y:32,width:16,height:16},"007.png":{x:16,y:32,width:16,height:16},"008.png":{x:32,y:32,width:16,height:16},"009.png":{x:48,y:0,width:16,height:16},"010.png":{x:48,y:16,width:16,height:16},"011.png":{x:48,y:32,width:16,height:16},"012.png":{x:0,y:48,width:16,height:16},"013.png":{x:16,y:48,width:16,height:16},"014.png":{x:32,y:48,width:16,height:16},"015.png":{x:48,y:48,width:16,height:16},"016.png":{x:64,y:0,width:16,height:16},"017.png":{x:64,y:16,width:16,height:16},"018.png":{x:64,y:32,width:16,height:16},"019.png":{x:64,y:48,width:16,height:16},"020.png":{x:0,y:64,width:16,height:16},"021.png":{x:16,y:64,width:16,height:16},"022.png":{x:32,y:64,width:16,height:16},"023.png":{x:48,y:64,width:16,height:16},"024.png":{x:64,y:64,width:16,height:16},"025.png":{x:80,y:0,width:16,height:16},"026.png":{x:80,y:16,width:16,height:16},"027.png":{x:80,y:32,width:16,height:16},"028.png":{x:80,y:48,width:16,height:16},"029.png":{x:80,y:64,width:16,height:16},"030.png":{x:0,y:80,width:16,height:16},"031.png":{x:16,y:80,width:16,height:16},"032.png":{x:32,y:80,width:16,height:16},"033.png":{x:48,y:80,width:16,height:16},"034.png":{x:64,y:80,width:16,height:16},"035.png":{x:80,y:80,width:16,height:16},"036.png":{x:96,y:0,width:16,height:16},"037.png":{x:96,y:16,width:16,height:16},"038.png":{x:96,y:32,width:16,height:16},"039.png":{x:96,y:48,width:16,height:16},"040.png":{x:96,y:64,width:16,height:16},"041.png":{x:96,y:80,width:16,height:16},"042.png":{x:0,y:96,width:16,height:16},"043.png":{x:16,y:96,width:16,height:16},"044.png":{x:32,y:96,width:16,height:16},"045.png":{x:48,y:96,width:16,height:16},"046.png":{x:64,y:96,width:16,height:16},"047.png":{x:80,y:96,width:16,height:16},"048.png":{x:96,y:96,width:16,height:16},"049.png":{x:112,y:0,width:16,height:16},"050.png":{x:112,y:16,width:16,height:16},"051.png":{x:112,y:32,width:16,height:16},"052.png":{x:112,y:48,width:16,height:16},"053.png":{x:112,y:64,width:16,height:16},"054.png":{x:112,y:80,width:16,height:16},"055.png":{x:112,y:96,width:16,height:16},"056.png":{x:0,y:112,width:16,height:16},"057.png":{x:16,y:112,width:16,height:16},"058.png":{x:32,y:112,width:16,height:16},"059.png":{x:48,y:112,width:16,height:16},"060.png":{x:64,y:112,width:16,height:16},"061.png":{x:80,y:112,width:16,height:16},"062.png":{x:96,y:112,width:16,height:16},"063.png":{x:112,y:112,width:16,height:16},"064.png":{x:128,y:0,width:16,height:16},"065.png":{x:128,y:16,width:16,height:16},"066.png":{x:128,y:32,width:16,height:16},"067.png":{x:128,y:48,width:16,height:16},"068.png":{x:128,y:64,width:16,height:16},"069.png":{x:128,y:80,width:16,height:16},"070.png":{x:128,y:96,width:16,height:16},"071.png":{x:128,y:112,width:16,height:16},"072.png":{x:0,y:128,width:16,height:16},"073.png":{x:16,y:128,width:16,height:16},"074.png":{x:32,y:128,width:16,height:16},"075.png":{x:48,y:128,width:16,height:16},"076.png":{x:64,y:128,width:16,height:16},"077.png":{x:80,y:128,width:16,height:16},"078.png":{x:96,y:128,width:16,height:16},"079.png":{x:112,y:128,width:16,height:16},"080.png":{x:128,y:128,width:16,height:16},"081.png":{x:144,y:0,width:16,height:16},"082.png":{x:144,y:16,width:16,height:16},"083.png":{x:144,y:32,width:16,height:16},"084.png":{x:144,y:48,width:16,height:16},"085.png":{x:144,y:64,width:16,height:16},"086.png":{x:144,y:80,width:16,height:16},"087.png":{x:144,y:96,width:16,height:16},"088.png":{x:144,y:112,width:16,height:16},"089.png":{x:144,y:128,width:16,height:16},"090.png":{x:0,y:144,width:16,height:16},"091.png":{x:16,y:144,width:16,height:16},"092.png":{x:32,y:144,width:16,height:16},"093.png":{x:48,y:144,width:16,height:16},"094.png":{x:64,y:144,width:16,height:16},"095.png":{x:80,y:144,width:16,height:16},"096.png":{x:96,y:144,width:16,height:16},"097.png":{x:112,y:144,width:16,height:16},"098.png":{x:128,y:144,width:16,height:16},"099.png":{x:144,y:144,width:16,height:16},"100.png":{x:160,y:0,width:16,height:16},"101.png":{x:160,y:16,width:16,height:16},"102.png":{x:160,y:32,width:16,height:16},"103.png":{x:160,y:48,width:16,height:16},"104.png":{x:160,y:64,width:16,height:16},"105.png":{x:160,y:80,width:16,height:16},"106.png":{x:160,y:96,width:16,height:16},"107.png":{x:160,y:112,width:16,height:16},"108.png":{x:160,y:128,width:16,height:16},"109.png":{x:160,y:144,width:16,height:16},"110.png":{x:0,y:160,width:16,height:16},"111.png":{x:16,y:160,width:16,height:16},"112.png":{x:32,y:160,width:16,height:16},"113.png":{x:48,y:160,width:16,height:16},"114.png":{x:64,y:160,width:16,height:16},"115.png":{x:80,y:160,width:16,height:16},"116.png":{x:96,y:160,width:16,height:16},"117.png":{x:112,y:160,width:16,height:16},"118.png":{x:128,y:160,width:16,height:16},"119.png":{x:144,y:160,width:16,height:16},"120.png":{x:160,y:160,width:16,height:16},"121.png":{x:176,y:0,width:16,height:16},"122.png":{x:176,y:16,width:16,height:16},"123.png":{x:176,y:32,width:16,height:16},"124.png":{x:176,y:48,width:16,height:16},"125.png":{x:176,y:64,width:16,height:16},"126.png":{x:176,y:80,width:16,height:16},"127.png":{x:176,y:96,width:16,height:16},"128.png":{x:176,y:112,width:16,height:16},"129.png":{x:176,y:128,width:16,height:16},"130.png":{x:176,y:144,width:16,height:16},"131.png":{x:176,y:160,width:16,height:16}},et=[0,0],ot=0,st=[0,0],gt=[0,0],rt=8708,dt=[0,0],ct=131072,ut=[0,0],lt=262144,at=Math.PI/180,wt=[0,0],pt=524292,yt=[{data:[14,51,16,1,1,3221225485,1,1,1,2,3,3,3,3,3,4,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,14,1610612787,17,3,3,4,1,1,1,14,41,41,41,41,41,16,1,1,1,1,1,25,1,1,1,1,1,1,1,1,1073741837,1,14,1610612787,58,41,41,16,25,1,1,14,1610612789,51,51,52,51,16,2,3,4,1,1,1,1,2,3,7,3,3,3,7,3,4,14,1610612787,51,52,51,16,1,1,1,14,1610612787,49,3221225522,49,49,16,14,41,16,1,1,536870925,1,14,41,19,41,30,41,19,41,16,14,1610612787,5,27,27,28,1,1073741837,1,14,1610612787,49,49,49,49,16,14,1610612789,16,1,1,1,1073741837,14,1610612789,31,51,51,52,31,51,16,14,1610612787,16,2,3,3,3,3,4,26,27,27,27,27,27,28,14,1610612787,17,7,3,3,4,14,1610612787,49,49,49,49,49,49,16,14,1610612787,16,14,41,41,41,41,17,3,3,3,3,4,1,1,14,1610612787,58,19,41,41,16,14,1610612787,49,49,49,49,49,49,16,18,1610612787,17,18,1610612789,51,52,51,58,41,41,22,41,16,2684354573,1,14,1610612787,51,31,51,51,16,14,1610612787,49,49,49,49,49,49,16,60,1610612787,58,60,1610612787,49,49,49,51,51,51,51,51,17,3,3,18,1610612787,49,43,49,3221225522,17,18,1610612787,49,49,49,49,49,2684354610,17,51,54,51,51,54,43,49,50,49,49,49,49,49,58,41,41,60,1610612787,49,49,43,49,58,60,37,38,38,38,38,38,39,58,49,43,49,49,49,49,49,49,49,49,49,49,49,51,52,51,51,54,49,49,49,49,51,52,54,49,49,49,49,49,49,51,49,49,49,5,27,6,1610612790,49,49,2147483698,49,49,49,49,49,49,49,49,49,49,49,49,49,5,27,27,27,27,27,27,27,27,49,49,49,16,1,14,1610612787,49,49,49,49,49,49,5,27,27,27,27,27,27,6,1610612790,49,16,1,1,1,1,1,1,1,1,27,27,27,28,3221225485,14,1610612787,49,49,5,27,27,27,28,2,3,3,3,3,3,18,1610612787,49,16,1,1,1,2,3,3,3,3,1,1,1,1,2,18,1610612787,49,49,17,3,4,1,1,14,41,20,41,41,21,60,1610612787,49,16,1,1,1073741837,14,41,11,12,41,1,2,3,3,18,60,1610612787,49,49,58,41,17,3,3,18,1610612789,32,51,51,33,51,54,2147483698,16,1,1,1,14,1610612789,51,51,51,1,14,41,41,60,1610612789,54,49,49,51,51,58,41,41,60,1610612787,49,43,49,49,49,49,49,17,3,3,3,18,1610612787,49,49,49,1,14,1610612789,52,51,54,49,49,2147483698,42,49,51,51,51,51,54,43,49,49,49,49,49,49,58,41,41,41,60,1610612787,49,49,49,1,14,1610612787,3758096434,49,49,49,49,49,3758096434,49,49,49,49,49,49,49,49,49,49,49,43,49,51,51,51,51,51,54,49,49,49,1,14,1610612787,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,3758096434,49],height:20,id:1,name:"Dungeon",opacity:1,type:"tilelayer",visible:!0,width:32,x:0,y:0},{data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,76,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,87,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,75,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66,0,65,0,65,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,67,0,67,0,67,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,121,0,0,0,0,0,0,0,0,0,0,0,112,0,0,0,62,0,0,0,0,0,0,0,0,74,0,73,0,0,0,0,0,121,0,0,0,0,0,0,0,65,0,0,0,0,0,62,88,62,0,0,0,0,0,0,0,0,0,0,74,0,0,0,0,0,0,0,0,0,0,0,0,67,0,0,0,0,0,98,62,0,0,0,0,0,85,0,0,0,2147483758,0,0,0,0,0,0,0,0,0,0,0,0,0,65,0,0,0,0,0,0,0,0,99,61,0,0,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,0,0,0,0,67,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68,0,0,0,0,0,0,0,0,0,0,0,0,0,78,78,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,124,0,0,0,0,0,0,0,0,0,83,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,124,0,0,0,0,0,0,0,0,0,90,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,2147483773,0,0,0,0,0,0,0,0,2147483749,0,0,0,0,0,0,0,0,94,71,71,71,71,71,72,0,0,0,0,0,0,0,0,0,0,0,0,83,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,82,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:20,id:4,name:"Objects",opacity:1,type:"tilelayer",visible:!1,width:32,x:0,y:0},{data:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,56,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,55,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],height:20,id:5,name:"Carts",opacity:1,type:"tilelayer",visible:!1,width:32,x:0,y:0}],xt=new class extends class extends class{constructor(){this.Nt=0,this.Jt=0,this.At=window.innerWidth,this.St=window.innerHeight,this.Qt=!0,this.C={MouseX:0,MouseY:0},this.Zt={MouseX:0,MouseY:0},this.ti={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.ii={},this.Lt=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.hi():this.ni())),this.Lt.addEventListener("contextmenu",(t=>t.preventDefault())),this.Lt.addEventListener("mousedown",(t=>{this.C["Mouse"+t.button]=1,this.Zt["Mouse"+t.button]=1})),this.Lt.addEventListener("mouseup",(t=>{this.C["Mouse"+t.button]=0,this.Zt["Mouse"+t.button]=-1})),this.Lt.addEventListener("mousemove",(t=>{this.C.MouseX=t.clientX,this.C.MouseY=t.clientY,this.Zt.MouseX=t.movementX,this.Zt.MouseY=t.movementY})),this.Lt.addEventListener("wheel",(t=>{t.preventDefault(),this.Zt.WheelY=t.deltaY})),this.Lt.addEventListener("touchstart",(t=>{t.target===this.Lt&&t.preventDefault(),1===t.touches.length&&(this.ii={});for(let i=0;i<t.touches.length;i++)this.ii[t.touches[i].identifier]=i;for(let i=0;i<t.changedTouches.length;i++){let h=t.changedTouches[i],n=this.ii[h.identifier];this.C["Touch"+n]=1,this.C[`Touch${n}X`]=h.clientX,this.C[`Touch${n}Y`]=h.clientY,this.Zt["Touch"+n]=1,this.Zt[`Touch${n}X`]=0,this.Zt[`Touch${n}Y`]=0}})),this.Lt.addEventListener("touchmove",(t=>{t.target===this.Lt&&t.preventDefault();for(let i=0;i<t.changedTouches.length;i++){let h=t.changedTouches[i],n=this.ii[h.identifier];this.Zt[`Touch${n}X`]=h.clientX-this.C[`Touch${n}X`],this.Zt[`Touch${n}Y`]=h.clientY-this.C[`Touch${n}Y`],this.C[`Touch${n}X`]=h.clientX,this.C[`Touch${n}Y`]=h.clientY}})),this.Lt.addEventListener("touchend",(t=>{t.target===this.Lt&&t.preventDefault();for(let i=0;i<t.changedTouches.length;i++){let h=this.ii[t.changedTouches[i].identifier];this.C["Touch"+h]=0,this.Zt["Touch"+h]=-1}})),this.Lt.addEventListener("touchcancel",(t=>{for(let i=0;i<t.changedTouches.length;i++){let h=this.ii[t.changedTouches[i].identifier];this.C["Touch"+h]=0,this.Zt["Touch"+h]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.C[t.code]=1,this.Zt[t.code]=1)})),window.addEventListener("keyup",(t=>{this.C[t.code]=0,this.Zt[t.code]=-1}))}ni(){let t=0,i=performance.now(),h=n=>{let e=(n-i)/1e3;for(i=n,this.Nt=requestAnimationFrame(h),this.ei(e),t+=e;t>=tt;)t-=tt,this.oi(tt);this.si(e),this.gi(e)};this.hi(),h(i)}hi(){cancelAnimationFrame(this.Nt),this.Nt=0}ei(t){this.Jt=performance.now();let i=Math.abs(this.Zt.MouseX)+Math.abs(this.Zt.MouseY);this.ti.Mouse+=i,1===this.C.Mouse0&&(this.ti.Mouse0+=i),1===this.C.Mouse1&&(this.ti.Mouse1+=i),1===this.C.Mouse2&&(this.ti.Mouse2+=i),1===this.C.Touch0&&(this.ti.Touch0+=Math.abs(this.Zt.Touch0X)+Math.abs(this.Zt.Touch0Y)),1===this.C.Touch1&&(this.ti.Touch1+=Math.abs(this.Zt.Touch1X)+Math.abs(this.Zt.Touch1Y))}oi(t){}si(t){}gi(t){this.Qt=!1,-1===this.Zt.Mouse0&&(this.ti.Mouse0=0),-1===this.Zt.Mouse1&&(this.ti.Mouse1=0),-1===this.Zt.Mouse2&&(this.ti.Mouse2=0),-1===this.Zt.Touch0&&(this.ti.Touch0=0),-1===this.Zt.Touch1&&(this.ti.Touch1=0);for(let t in this.Zt)this.Zt[t]=0;let i=performance.now()-this.Jt;J&&(J.textContent=i.toFixed(1)),Q&&(Q.textContent=(1e3*t).toFixed(1)),Z&&(Z.textContent=(1/t).toFixed())}}{constructor(){super(...arguments),this.ri=document.querySelector("#background"),this.di=this.ri.getContext("2d"),this.ci=document.querySelector("#foreground"),this.ui=this.ci.getContext("2d"),this.li=document.querySelector("#scene"),this.ct=this.li.getContext("webgl2"),this.Audio=new AudioContext,this.ai=[],this.wi={}}}{constructor(){super(),this.i=new ht(65536),this.rt=function(t,h,n){let e=function(t,h,n){let e=t.createProgram();return t.attachShader(e,i(t,35633,h)),t.attachShader(e,i(t,35632,"#version 300 es\n\nprecision mediump float;\n\nuniform sampler2D sheet_texture;\n\nin vec2 vert_texcoord;\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color * texture(sheet_texture, vert_texcoord);\nif (frag_color.a == 0.0) {\ndiscard;\n}\n}\n")),t.linkProgram(e),e}(t,"#version 300 es\n\nuniform mat3x2 pv;\nuniform vec2 sheet_size;\n\n\nlayout(location=0) in vec2 attr_position;\nlayout(location=1) in vec2 attr_texcoord;\n\n\nlayout(location=2) in vec4 attr_rotation; \nlayout(location=3) in vec4 attr_translation; \nlayout(location=4) in vec4 attr_color;\nlayout(location=5) in vec4 attr_sprite;\n\nout vec2 vert_texcoord;\nout vec4 vert_color;\nout vec4 vert_sprite;\n\nvoid main() {\nint signature = int(attr_translation.w);\nif ((signature & 4096) == 4096) {\nmat3x2 world;\nif ((signature & 32768) == 32768) {\nworld = mat3x2(\nattr_rotation.xy,\nattr_rotation.zw,\nattr_translation.xy\n);\n} else {\nvec2 scale = attr_rotation.xy;\nfloat rotation = attr_rotation.z;\nworld = mat3x2(\ncos(rotation) * scale.x, sin(rotation) * scale.x,\n-sin(rotation) * scale.y, cos(rotation) * scale.y,\nattr_translation.xy\n);\n}\n\nvec3 world_position = mat3(world) * vec3(attr_position, 1);\nvec3 clip_position = mat3(pv) * world_position;\ngl_Position = vec4(clip_position.xy, -attr_translation.z, 1);\n\n\nvert_texcoord = (attr_sprite.xy + attr_sprite.zw * attr_texcoord) / sheet_size;\nvert_color = attr_color;\n} else {\n\ngl_Position.z = 2.0;\n}\n}");return{Tt:5,ut:e,wt:{lt:t.getUniformLocation(e,"pv"),i:t.getUniformLocation(e,"world"),xt:t.getUniformLocation(e,"sheet_texture"),ft:t.getUniformLocation(e,"sheet_size")}}}(this.ct),this.dt=function(t,i){let h=t.createTexture();return t.bindTexture(K,h),t.texImage2D(K,0,6408,6408,5121,i),t.texParameteri(K,10241,9728),t.texParameteri(K,10240,9728),t.texParameteri(K,10242,10497),t.texParameteri(K,10243,10497),{yt:h,vt:i.width,_t:i.height}}(this.ct,document.querySelector("img")),this.H=new Float32Array(this.i.Wt*it),this.Mt=this.ct.createBuffer(),this.pi="#763b36",this.yi=32,this.xi=20,this.ct.clearColor(0,0,0,0),this.ct.enable(2929),this.ct.enable(3042),this.ct.blendFunc(770,771),function(t,i){let h=Float32Array.from([-.5,-.5,0,1,.5,-.5,1,1,-.5,.5,0,0,.5,.5,1,0]);t.bindBuffer(B,t.createBuffer()),t.bufferData(B,h,35044),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,2,N,!1,16,0),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,2,N,!1,16,8),t.bindBuffer(B,i),t.enableVertexAttribArray(2),t.vertexAttribDivisor(2,1),t.vertexAttribPointer(2,4,N,!1,64,0),t.enableVertexAttribArray(3),t.vertexAttribDivisor(3,1),t.vertexAttribPointer(3,4,N,!1,64,16),t.enableVertexAttribArray(4),t.vertexAttribDivisor(4,1),t.vertexAttribPointer(4,4,N,!1,64,32),t.enableVertexAttribArray(5),t.vertexAttribDivisor(5,1),t.vertexAttribPointer(5,4,N,!1,64,48)}(this.ct,this.Mt)}oi(t){!function(t,i){for(let h=0;h<t.i.$.length;h++)8704==(8704&t.i.$[h])&&A(t,h,i)}(this,t),V(this),function(t,i){let h=[],n=[];for(let i=0;i<t.i.$.length;i++)if(32772==(32772&t.i.$[i])){let e=t.i.nt[i],o=t.i.U[i];o.v=[],o.V?(o.V=!1,r(e.i,o)):o.W?(r(e.i,o),n.push(o)):h.push(o)}for(let t=0;t<n.length;t++)c(n[t],h,h.length),c(n[t],n,t)}(this),function(t,i){for(let i=0;i<t.i.$.length;i++)(t.i.$[i]&rt)===rt&&S(t,i);for(let i=0;i<t.i.$.length;i++)if((t.i.$[i]&rt)===rt){let h=t.i.S[i];1===h.G&&a(h.K,h.N)}}(this),function(t,i){for(let i=0;i<t.i.$.length;i++)(t.i.$[i]&pt)===pt&&I(t,i)}(this)}si(i){!function(t,i){let h=[];for(let n=0;n<t.i.$.length;n++)if((t.i.$[n]&ct)===ct){if(C(t.i,n))continue;let e=t.i.Bt[n];switch(e.G){case 0:e.fi(n)&&h.push(n);break;case 1:e.ht-=i,e.ht<0&&h.push(n);break;case 2:h.push(n)}}for(let i of h){let h=t.i.Bt[i];switch(h.G){case 2:h.vi(i);case 0:case 1:t.i.tt(i)}delete t.i.Bt[i]}}(this,i),function(t,i){if(t.At==window.innerWidth&&t.St==window.innerHeight||(t.Qt=!0),t.Qt){t.At=t.ri.width=t.li.width=t.ci.width=window.innerWidth,t.St=t.ri.height=t.li.height=t.ci.height=window.innerHeight;for(let i=0;i<t.i.$.length;i++)2==(2&t.i.$[i])&&Y(t,i)}}(this),function(t,i){t.ai=[];for(let i=0;i<t.i.$.length;i++)if(32770==(32770&t.i.$[i])){let o=t.i.$t[i],s=t.i.nt[i];e(o.lt,o.Ct.Ct,s.ot),h(o.i,(n=s.i)[0],n[1],n[2],n[3],n[4],n[5]),t.ai.push(i)}var n}(this),function(t,i){for(let i=0;i<t.i.$.length;i++)9232==(9232&t.i.$[i])&&l(t,i)}(this),function(i,h){if(ot+=h,!function(t,i){return 1===t.C.Touch0||-1===t.Zt.Touch0?(i[0]=t.C.Touch0X,i[1]=t.C.Touch0Y,!0):t.ti.Mouse>0&&(i[0]=t.C.MouseX,i[1]=t.C.MouseY,!0)}(i,et))return;let n=i.ai[0];if(void 0!==n){(e=et)[0]=(s=et)[0]/(o=i.i.$t[n]).At*2-1,e[1]=-s[1]/o.St*2+1,x(e,e,o.Ct.Xt),x(e,e,o.i);for(let t=0;t<i.i.$.length;t++)528==(528&i.i.$[t])&&(a(i.i.Y[t].D,et),i.i.$[t]|=64);ot>.1&&function(t,i,h=i){return t.C["Mouse"+i]>0||t.C["Touch"+h]>0}(i,0)&&(t(i,[f(),_(!0,2,3),k(1,.3),M("121.png"),T(.9),(t,i)=>{t.i.$[i]|=256,t.i.it[i]={ht:10,mi:void 0}},m(et)]),ot=0)}var e,o,s}(this,i),function(t,i){for(let i=0;i<t.i.$.length;i++)1032==(1032&t.i.$[i])&&u(t,i)}(this),function(t,i){for(let h=0;h<t.i.$.length;h++)1600==(1600&t.i.$[h])&&$(t,h,i)}(this,i),function(t,i){for(let h=0;h<t.i.$.length;h++)256==(256&t.i.$[h])&&F(t,h,i)}(this,i),function(t,i){for(let i=0;i<t.i.$.length;i++)16896==(16896&t.i.$[i])&&D(t,i)}(this),function(t,i){for(let h=0;h<t.i.$.length;h++)(t.i.$[h]&lt)==lt&&U(t,h,i)}(this,i),function(t,i){for(let h=0;h<t.i.$.length;h++)98304==(98304&t.i.$[h])&&R(t,h,i)}(this,i),V(this),function(t,i){let h=t.ai[0];if(void 0===h)return;let n=t.i.$t[h],e=t.di;e.resetTransform(),e.fillStyle=t.pi,e.fillRect(0,0,t.At,t.St),e.transform(n.lt[0]/2*t.At,-n.lt[1]/2*t.At,-n.lt[2]/2*t.St,n.lt[3]/2*t.St,(n.lt[4]+1)/2*t.At,(n.lt[5]+1)/2*t.St);for(let i=0;i<t.i.$.length;i++)if(32896==(32896&t.i.$[i])){let h=t.i.nt[i];e.save(),e.transform(h.i[0],-h.i[1],-h.i[2],h.i[3],h.i[4],-h.i[5]);let n=t.i.Gt[i];switch(n.G){case 1:e.fillStyle=n.L,e.fillRect(-n.vt/2,-n._t/2,n.vt,n._t);break;case 2:e.fillStyle=n.L,e.beginPath(),e.arc(0,0,n.Pt,n._i,n.Mi),e.fill()}e.restore()}}(this),function(t,i){for(let h=0;h<t.i.$.length;h++)4097==(4097&t.i.$[h])&&X(t,h,i)}(this,i),function(t,i){for(let i=0;i<t.i.$.length;i++){let h=36864&t.i.$[i],n=i*it+7;t.H[n]!==h&&(t.H[n]=h)}for(let i of t.ai){let h=t.i.$t[i];t.ct.bindFramebuffer(36160,null),t.ct.viewport(0,0,t.At,t.St),t.ct.clear(16640),P(t,h);break}}(this),E(this)}};(q=xt).i=new ht(65536),q.Qt=!0,t(q,[...function(t){return[O(),f(),(i=[t.yi/2+1,t.xi/2+1],(t,h)=>{t.i.$[h]|=2,t.i.$t[h]={Ct:{Pt:i,Ct:[1/i[0],0,0,1/i[1],0,0],Xt:[i[0],0,0,i[1],0,0]},lt:[1,0,0,1,0,0],i:[1,0,0,1,0,0],At:0,St:0}})];var i}(q),v(16,10)]),t(q,[f(),(t,i)=>{t.i.$[i]|=16,t.i.Ot[i]={}},M("060.png"),T(1),v(16,10)]),L(q,yt[0],.1),L(q,yt[1],.2),L(q,yt[2],.3),xt.ni(),window.$=function(t,i,h){}.bind(null,xt),window.game=xt})();
